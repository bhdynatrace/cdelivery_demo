<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
  <modelVersion>4.0.0</modelVersion>
  <groupId>org.dynatrace</groupId>
  <artifactId>cdelivery_demo</artifactId>
  <packaging>war</packaging>
  <version>0.0.1-SNAPSHOT</version>
  <name>cdelivery_demo Maven Webapp</name>
  <url>http://maven.apache.org</url>
  <properties>  
  	  <!-- Set the version of Dynatrace we are working with -->
	  <dynaTrace.version>6.1</dynaTrace.version>
	  
	  <!-- Setting default values for Dynatrace Maven goals that operate on a system profile -->
	  <dynaTrace.username>admin</dynaTrace.username>  
	  <dynaTrace.password>admin</dynaTrace.password>  
	  <dynaTrace.serverUrl>http://dynatrace_server:8020</dynaTrace.serverUrl>
	  <dynaTrace.profileName>stage</dynaTrace.profileName>
	  <dynaTrace.collector>dynatrace_server</dynaTrace.collector>
	  <dynaTrace.versionBuild>${BUILD_ID}</dynaTrace.versionBuild>
	  <dynaTrace.systemProfile>maven</dynaTrace.systemProfile>
	  
	  <!-- Establish what category we plan on testing, environmentally aware -->
	  <dynaTrace.testCategory>unit</dynaTrace.testCategory>
	  
	  <!-- goal properties for dtAutomation: startRecording -->
	  <dynatrace.sessionName>Stored Testting Session</dynatrace.sessionName>
	  <dynatrace.sessionDescription>Testing Session for Performance Analysis</dynatrace.sessionDescription>
	  <dynatrace.recordingOption>all</dynatrace.recordingOption>
	  <dynatrace.sessionLocked>false</dynatrace.sessionLocked> <!-- Let's keep the testing sessions deletable -->
	  <dynatrace.appendTimestamp>false</dynatrace.appendTimestamp>
	  
	  <!-- goal properties for dtAutomation: stopRecording -->
	  <dynatrace.doReanalyzeSession>true</dynatrace.doReanalyzeSession>
	  <dynatrace.reanalyzeSessionTimeout>60000</dynatrace.reanalyzeSessionTimeout>
	  <dynatrace.reanalyzeSessionPollingInterval>5000</dynatrace.reanalyzeSessionPollingInterval>
	  <dynatrace.reanalyzeStatusProperty>dynatrace.status</dynatrace.reanalyzeStatusProperty>   
	  
	  <!-- This property will be used to store the actual Session Name for e.g.: Start/Stop Recording -->  
	  <dynaTrace.sessionNameProperty>dynaTrace.sessionName</dynaTrace.sessionNameProperty>   
  </properties>
  <profiles>
  	<profile><id>development</id></profile>
  	<profile><id>stage</id></profile>
  	<profile><id>production</id></profile>
  </profiles>
  <dependencies>
    <dependency>
      	<groupId>junit</groupId>
      	<artifactId>junit</artifactId>
      	<version>4.12</version>
      	<scope>test</scope>
    </dependency>
    <dependency>
      	<groupId>mysql</groupId>
      	<artifactId>mysql-connector-java</artifactId>
      	<version>5.1.6</version>
    </dependency>
  </dependencies>
  <build>
    <finalName>cdelivery_demo</finalName>
    <pluginManagement>
    <plugins>
    	<plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-surefire-plugin</artifactId>
            <version>2.17</version>
            <configuration>               
             <!-- launch a new JVM for all tests -->
                <forkMode>once</forkMode> 
                                
 			<!-- load the Java agent in the new JVM and also pass the test run id (dtTestrunID property) to the agent -->                
 				<argLine>-agentpath:/opt/dynatrace/agent/lib64/libdtagent.so=name=MavenBuild,server=${dynaTrace.collector},optionTestRunIdJava=${BUILD_ID}</argLine>            
 			</configuration>
    	</plugin>
    	      
    	 <plugin>            
    	 	<groupId>dynaTrace</groupId>            
    	 	<artifactId>dtAutomation</artifactId>            
    	 	<version>${dynaTrace.version}</version>
    	 	            
    	 	<executions>                
    	 		<execution>                    
    	 		<id>DT_StartTest_UnitTest</id>                   
    	  		<configuration>                        
    	  				<!-- overwrite configuration properties if necessary -->
                       	<versionMajor>1</versionMajor>                        
                       	<versionMinor>0</versionMinor>                        
                       	<versionRevision>0</versionRevision>                  
                       	<versionMilestone>1</versionMilestone>   
                       	<versionBuild>${BUILD_ID}</versionBuild> 
                       	<category>unit</category>
                       	<profileName>maven</profileName>
                              <username>${dynaTrace.username}</username>  
                              <password>${dynaTrace.password}</password>  
                       	<serverUrl>${dynaTrace.serverUrl}</serverUrl>
                       	<additionalProperties></additionalProperties> 
           		</configuration> 
                                                             
            	<phase>process-test-classes</phase>                    
            	<goals>                       
	             	<goal>startTest</goal>                    
    	        </goals>                
        	    </execution>             
           </executions>        
        </plugin>
        </plugins>
        </pluginManagement>
  </build>
  <organization>
  	<name>Dynatrace</name>
  	<url>www.dynatrace.com</url>
  </organization>
  <scm>
  	<url>https://github.com/bhdynatrace/cdelivery_demo</url>
  	<connection>scm:git:git@github.com:bhdynatrace/cdelivery_demo.git</connection>
  	<developerConnection>scm:git:git@github.com:bhdynatrace/cdelivery_demo.git</developerConnection>
  </scm>
  <ciManagement>
  	<system>Jenkins</system>
  	<url>dynatrace_server:8050</url>
  </ciManagement>
</project>
